<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>My Photo Portfolio</title>
</head>

<body>

  <h1>My Portfolio</h1>

  <input type="file" id="fileInput">
  <button onclick="uploadPhoto()">Upload</button>

  <div id="gallery"></div>

  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

  <script>
    const supabaseUrl = 'https://zpvamxwkaucqcmxittyv.supabase.co'
    const supabaseKey = 'sb_publishable_J2TZdEJokoS6XYrP3CkHrQ_kRsfJoJr'
    const supabase = window.supabase.createClient(supabaseUrl, supabaseKey)

    async function uploadPhoto() {
      const file = document.getElementById('fileInput').files[0]
      if (!file) {
        alert('请选择照片')
        return
      }

      const fileName = Date.now() + '-' + file.name
      const { error } = await supabase.storage
        .from('photos')
        .upload(fileName, file)

      if (error) {
        alert('上传失败')
      } else {
        loadPhotos()
      }
    }

    async function loadPhotos() {
      const { data } = await supabase.storage.from('photos').list()
      const gallery = document.getElementById('gallery')
      gallery.innerHTML = ''

      data.forEach(file => {
        const img = document.createElement('img')
        img.src = supabase.storage
          .from('photos')
          .getPublicUrl(file.name).data.publicUrl
        gallery.appendChild(img)
      })
    }

    loadPhotos()
  </script>

</body>
</html>
